# 网络

## URL

Uniform Resource Locator(统一资源定位符)，网络中每一个资源都对应唯一的地址—URL。

- URL的基本格式

- - 协议://主机地址:端口号/路径

  - - 协议： 不同的协议代表不同的资源获取方式

  - - 主机地址：主机的唯一标示(IP地址、域名)

  - - 路径：资源在主机中的具体位置

- - 举例：

  - - http://www.itheima.com/
    - http://www.itheima.com/images/xx00.png
    - ftp://www.itheima.com/movies/cls.avi

- URL的常见协议

- -  HTTP、FTP、mailto、File、tel://、sms://

## HTTP简介

- - HyperText Transport Protocol(超文本传输协议)
  - 浏览器和Web服务器通讯时候遵守的约定
  - 互联网使用最多的协议
  - 提供超文本传输服务
  - 通过浏览器打开网站使用的就是HTTP提供的服务，开发App也会经常使用HTTP协议从网络上获取数据

- ### TCP和UDP

- 简单来说TCP协议传输得到的数据是正确的，而UDP得到的数据是有可能有问题的，因为TCP在网络层的协议一定有校验码，而UDP是不一定要校验码的，因此无法确保100%正确，现在阶段的网络传输误码率是非常非常低的，因此UDP也还是不错的选择

- TCP: 要求可靠性高的时候用，因为TCP在建立连接器要经过三次通信才会建立连接通道，并且校验发现错误会要求重发。（比如下载）

- UDP: 要求实时性比较高，经济实惠省流量的时候使用。直接就建立连接的通道，数据错误也不会要求重发（比如打电话，直播）

## Socket（套接字）


Socket又称“套接字”，应用程序通过“套接字”向网络发送请求或向网络做出应答。

网络通信其实就Socket之间的通信，数据在两个Socket之间通过IO传输数据，Socket是纯C语言的，是跨平台的，**HTTP协议是基于Socket的，HTTP协议的底层使用的就是Socket**。Socket就是在应用层和传输层之间的协议。

**Socket的通信过程**：

- 创建Socket

  - 导入头文件
    - \#import <sys/socket.h>
    - \#import <netinet/in.h>
    - \#import <arpa/inet.h>

  - 创建Socket`int socket(int domain, int type, int protocol);`
    - 参数1 domain 协议域 AF_INET--IPV4
    - 参数2 type  socket类型 SOCK_STREAM(TCP)/SOCKET_DGRAM(UDP)
    - 参数3 protocol IPPROTO_TCP/IPPROTO_UDP  如果 传入0 会根据第二个参数选择合适的值
    - 返回值 >0 创建成功 socket的描述符

  - 示例：int clientSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);

- 连接到服务器

  - 定义函数：int connect(int sockfd, struct sockaddr * serv_addr, int addrlen);
    - sockfd：标识一个套接字。
    - serv_addr：结构体套接字s想要连接的主机地址和端口号。
    - addrlen：结构体的长度。

  ```objc
  struct sockaddr_in addr;
  addr.sin_family = AF_INET;
  addr.sin_addr.s_addr = inet_addr("192.168.88.100");
  addr.sin_port = htons(3000);
  int result = connect(clientSocket, (const struct sockaddr *) &addr, sizeof(addr));
  ```

- 发送数据给服务器

- 从服务器接收数据

- 关闭连接

