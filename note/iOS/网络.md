# ç½‘ç»œ

## URL

Uniform Resource Locator(ç»Ÿä¸€èµ„æºå®šä½ç¬¦)ï¼Œç½‘ç»œä¸­æ¯ä¸€ä¸ªèµ„æºéƒ½å¯¹åº”å”¯ä¸€çš„åœ°å€â€”URLã€‚

- URLçš„åŸºæœ¬æ ¼å¼

  - åè®®://ä¸»æœºåœ°å€:ç«¯å£å·/è·¯å¾„

    - åè®®ï¼š ä¸åŒçš„åè®®ä»£è¡¨ä¸åŒçš„èµ„æºè·å–æ–¹å¼

    - ä¸»æœºåœ°å€ï¼šä¸»æœºçš„å”¯ä¸€æ ‡ç¤º(IPåœ°å€ã€åŸŸå)

    - è·¯å¾„ï¼šèµ„æºåœ¨ä¸»æœºä¸­çš„å…·ä½“ä½ç½®

  - ä¸¾ä¾‹ï¼š

    - http://www.itheima.com/
    - http://www.itheima.com/images/xx00.png
    - ftp://www.itheima.com/movies/cls.avi

- URLçš„å¸¸è§åè®®

- -  HTTPã€FTPã€mailtoã€Fileã€tel://ã€sms://

## HTTPç®€ä»‹

- HyperText Transport Protocol(è¶…æ–‡æœ¬ä¼ è¾“åè®®)
  - æµè§ˆå™¨å’ŒWebæœåŠ¡å™¨é€šè®¯æ—¶å€™éµå®ˆçš„çº¦å®š
  - äº’è”ç½‘ä½¿ç”¨æœ€å¤šçš„åè®®
  - æä¾›è¶…æ–‡æœ¬ä¼ è¾“æœåŠ¡
  - é€šè¿‡æµè§ˆå™¨æ‰“å¼€ç½‘ç«™ä½¿ç”¨çš„å°±æ˜¯HTTPæä¾›çš„æœåŠ¡ï¼Œå¼€å‘Appä¹Ÿä¼šç»å¸¸ä½¿ç”¨HTTPåè®®ä»ç½‘ç»œä¸Šè·å–æ•°æ®

- ### TCPå’ŒUDP

- ç®€å•æ¥è¯´TCPåè®®ä¼ è¾“å¾—åˆ°çš„æ•°æ®æ˜¯æ­£ç¡®çš„ï¼Œè€ŒUDPå¾—åˆ°çš„æ•°æ®æ˜¯æœ‰å¯èƒ½æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºTCPåœ¨ç½‘ç»œå±‚çš„åè®®ä¸€å®šæœ‰æ ¡éªŒç ï¼Œè€ŒUDPæ˜¯ä¸ä¸€å®šè¦æ ¡éªŒç çš„ï¼Œå› æ­¤æ— æ³•ç¡®ä¿100%æ­£ç¡®ï¼Œç°åœ¨é˜¶æ®µçš„ç½‘ç»œä¼ è¾“è¯¯ç ç‡æ˜¯éå¸¸éå¸¸ä½çš„ï¼Œå› æ­¤UDPä¹Ÿè¿˜æ˜¯ä¸é”™çš„é€‰æ‹©

- TCP: è¦æ±‚å¯é æ€§é«˜çš„æ—¶å€™ç”¨ï¼Œå› ä¸ºTCPåœ¨å»ºç«‹è¿æ¥å™¨è¦ç»è¿‡ä¸‰æ¬¡é€šä¿¡æ‰ä¼šå»ºç«‹è¿æ¥é€šé“ï¼Œå¹¶ä¸”æ ¡éªŒå‘ç°é”™è¯¯ä¼šè¦æ±‚é‡å‘ã€‚ï¼ˆæ¯”å¦‚ä¸‹è½½ï¼‰

- UDP: è¦æ±‚å®æ—¶æ€§æ¯”è¾ƒé«˜ï¼Œç»æµå®æƒ çœæµé‡çš„æ—¶å€™ä½¿ç”¨ã€‚ç›´æ¥å°±å»ºç«‹è¿æ¥çš„é€šé“ï¼Œæ•°æ®é”™è¯¯ä¹Ÿä¸ä¼šè¦æ±‚é‡å‘ï¼ˆæ¯”å¦‚æ‰“ç”µè¯ï¼Œç›´æ’­ï¼‰

## Socketï¼ˆå¥—æ¥å­—ï¼‰


Socketåˆç§°â€œå¥—æ¥å­—â€ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡â€œå¥—æ¥å­—â€å‘ç½‘ç»œå‘é€è¯·æ±‚æˆ–å‘ç½‘ç»œåšå‡ºåº”ç­”ã€‚

ç½‘ç»œé€šä¿¡å…¶å®å°±Socketä¹‹é—´çš„é€šä¿¡ï¼Œæ•°æ®åœ¨ä¸¤ä¸ªSocketä¹‹é—´é€šè¿‡IOä¼ è¾“æ•°æ®ï¼ŒSocketæ˜¯çº¯Cè¯­è¨€çš„ï¼Œæ˜¯è·¨å¹³å°çš„ï¼Œ**HTTPåè®®æ˜¯åŸºäºSocketçš„ï¼ŒHTTPåè®®çš„åº•å±‚ä½¿ç”¨çš„å°±æ˜¯Socket**ã€‚Socketå°±æ˜¯åœ¨åº”ç”¨å±‚å’Œä¼ è¾“å±‚ä¹‹é—´çš„åè®®ã€‚

**Socketçš„é€šä¿¡è¿‡ç¨‹**ï¼š

- åˆ›å»ºSocket

  - å¯¼å…¥å¤´æ–‡ä»¶
    - \#import <sys/socket.h>
    - \#import <netinet/in.h>
    - \#import <arpa/inet.h>

  - åˆ›å»ºSocket`int socket(int domain, int type, int protocol);`
    - å‚æ•°1 domain åè®®åŸŸ AF_INET--IPV4
    - å‚æ•°2 type  socketç±»å‹ SOCK_STREAM(TCP)/SOCKET_DGRAM(UDP)
    - å‚æ•°3 protocol IPPROTO_TCP/IPPROTO_UDP  å¦‚æœ ä¼ å…¥0 ä¼šæ ¹æ®ç¬¬äºŒä¸ªå‚æ•°é€‰æ‹©åˆé€‚çš„å€¼
    - è¿”å›å€¼ >0 åˆ›å»ºæˆåŠŸ socketçš„æè¿°ç¬¦

  - ç¤ºä¾‹ï¼šint clientSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);

- è¿æ¥åˆ°æœåŠ¡å™¨

  - å®šä¹‰å‡½æ•°ï¼šint connect(int sockfd, struct sockaddr * serv_addr, int addrlen);
    - sockfdï¼šæ ‡è¯†ä¸€ä¸ªå¥—æ¥å­—ã€‚
    - serv_addrï¼šç»“æ„ä½“å¥—æ¥å­—sæƒ³è¦è¿æ¥çš„ä¸»æœºåœ°å€å’Œç«¯å£å·ã€‚
    - addrlenï¼šç»“æ„ä½“çš„é•¿åº¦ã€‚

  ```objc
  struct sockaddr_in addr;
  addr.sin_family = AF_INET;
  addr.sin_addr.s_addr = inet_addr("192.168.88.100");
  addr.sin_port = htons(3000);
  int result = connect(clientSocket, (const struct sockaddr *) &addr, sizeof(addr));
  // è¿”å›å€¼ä¸º0åˆ™è¿æ¥æˆåŠŸï¼Œéé›¶åˆ™è¿æ¥å¤±è´¥
  ```

- å‘é€æ•°æ®ç»™æœåŠ¡å™¨

  ```objc
  NSString *sendMsg = @"GET / HTTP/1.1\r\n"
                       "Host: www.baidu.com\r\n"
                       "Connection: close\r\n\r\n"];
  // è‡ªå·±å°è£…å¥½è¯·æ±‚å¤´ï¼ˆéµå®ˆHTTPåè®®ï¼‰ï¼Œæ‰å‘é€ç»™æœåŠ¡å™¨å‘é€
  const char *sendMessage = sendMsg.UTF8String;
  ssize_t sendLen = send(clientSocket, sendMessage, strlen(sendMessage), 0);
  NSLog(@"å‘é€çš„å­—èŠ‚æ•°ï¼š%ld",sendLen);
  ```

- ä»æœåŠ¡å™¨æ¥æ”¶æ•°æ®

  ```objc
  uint8_t buffer[1024];
  ssize_t recvCount = -1;
  NSMutableData *mData = [NSMutableData new];
  do {
      // å¾ªç¯æ¥æ”¶æ•°æ®ï¼Œç›´åˆ°æœåŠ¡å™¨ä¼ å®Œäº†æ‰åœæ­¢
      recvCount = recv(self.clientSocket, buffer, sizeof(buffer), 0);
      if (recvCount) {
          [mData appendBytes:buffer length:recvCount];
      }
  }while(recvCount != 0);
  NSString *res = [[NSString alloc] initWithData:mData encoding:NSUTF8StringEncoding];
  return res;
  ```

- å…³é—­è¿æ¥ `close(clientSocket);`

- è·å¾—å“åº”ä½“çš„å†…å®¹ï¼Œå³å“åº”å¤´å»æ‰

  ```objc
  // æˆªå–å“åº”å¤´ç»“æŸä½ç½®
  NSRange range = [res rangeOfString:@"\r\n\r\n"];
  // åœ¨å“åº”å¤´ç»“æŸä½ç½®åå¼€å§‹è·å¾—html
  NSString *html = [res substringFromIndex:range.location+range.length];
  ```

## JSON è§£æ

NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:data options:0 error:&error];

- å‚æ•°ä¸€ï¼šNSDataç±»å‹çš„äºŒè¿›åˆ¶æ•°æ®
- å‚æ•°äºŒï¼šoptionsï¼š
  - 0 ï¼ˆé€šå¸¸éƒ½ä¼ è¿™ä¸ªï¼‰
    - ä¸åšä»»ä½•å¤„ç†
  - NSJSONReadingMutableContainers = (1UL << 0) 
    - æŠŠå®¹å™¨ï¼ˆæœ€å¤–å±‚ï¼‰è½¬æˆå¯å˜çš„æ•°ç»„æˆ–è€…å¯å˜çš„è¯å…¸
  -  NSJSONReadingMutableLeaves = (1UL << 1)
    - å¦‚æœjsonå†…æ‰€æœ‰ä¸œè¥¿éƒ½å˜æˆå¯å˜çš„
  -  NSJSONReadingFragmentsAllowed = (1UL << 2)
    - å¦‚æœä¸æ˜¯åˆæ³•çš„JSONæ ¼å¼ï¼Œä¹Ÿè§£æï¼ˆé€šå¸¸éƒ½ä¸ç”¨ï¼‰
- å‚æ•°ä¸‰ï¼šNSError ä¸€ä¸ªå¯¹è±¡çš„åœ°å€

```objc
NSError *error;
NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:data options:0 error:&error];
if (error) {
    NSLog(@"JSONparse error: %@",error);
    return;
}
NSLog(@"%@",dict);
```

**è§£å†³è¾“å‡ºæ˜¯Unicodeæºç çš„é—®é¢˜**ï¼šç»™æ•°ç»„æˆ–è€…å­—å…¸å†™ä¸€ä¸ªç±»æ‰©å±•ï¼Œæ”¹å†™å…¶descriptionWithLocaleæ–¹æ³•Xcode8ä»¥å‰

```objc
- (NSString *)descriptionWithLocale:(id)locale{
    NSMutableString *msg = [NSMutableString new];
    [msg appendString:@"\r\n{\r\n"];
    for (id key in self) {
        [msg appendFormat:@"\t%@: %@,\r\n", key, self[key]];
    }
    [msg appendString:@"}"];
    return msg.copy;
}
```

xcode8ä»¥åé‡å†™çš„æ–¹æ³•å°±å˜äº†descriptionWithLocale:indext:level: é»˜è®¤è°ƒç”¨å˜æˆè¿™ä¸ªæ–¹æ³•äº†

```objc
- (NSString *)descriptionWithLocale:(id)locale indent:(NSUInteger)level{
    NSMutableString *msg = [NSMutableString new];
    [msg appendString:@"\r\n{\r\n"];
    for (id key in self) {
        [msg appendFormat:@"\t%@: %@,\r\n", key, self[key]];
    }
    [msg appendString:@"}"];
    return msg.copy;
}
```

ä¸ºäº†å¯ä»¥nslogç±»ä¸­çš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥é‡å†™ç±»çš„ descriptionæ–¹æ³•

```objc
- (NSString *)description
{
    return [NSString stringWithFormat:@"<%@: %p> {videoId: %@, name: %@, length: %@, videoURL: %@, imageURL: %@, desc: %@, teacher: %@, time: %@}", [self class], self, self.videoId, self.name, self.length, self.videoURL, self.imageURL, self.desc, self.teacher, self.time];
}
```

ä¸€ä¸ªåˆ†ç±»æ–‡ä»¶é‡Œé¢å¯ä»¥å†™å¤šä¸ªåˆ†ç±»ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ•°ç»„å’Œå­—å…¸éƒ½é‡å†™è¿™ä¸ªæ–¹æ³•å°±å¥½äº†ã€‚

**æ³¨æ„**ï¼šæˆ‘ä»¬ç»™JSONåšå­—å…¸è½¬æ¨¡å‹çš„æ—¶å€™ä¸€äº›æ•°ç»„ç±»å‹æˆ‘ä»¬éƒ½ç”¨NSNumberæ¥æ”¶ï¼Œå› ä¸ºæœ‰å¯èƒ½æœåŠ¡å™¨è¿”å›çš„æ˜¯nullï¼Œç”¨intã€floatè¿™äº›æ¥æ”¶ä¼šæŠ¥é”™

## Plist è§£æ

å¼€å‘çš„æ—¶å€™æ— è®ºæ˜¯ç½‘ç»œè¿˜æ˜¯æœ¬åœ°é€šå¸¸éƒ½ä¸ç”¨plistï¼Œé¦–å…ˆæ•°æ®é‡å¤§ï¼Œå†è€…ä¸å¯èƒ½åªåšiOSï¼Œpliståˆ«çš„è¯­è¨€æ˜¯è§£æä¸äº†çš„

```objc
NSError *error;
NSArray *arr = [NSPropertyListSerialization propertyListWithData:data options:0 format:0 error:&error];
if (error) {
    NSLog(@"plistparse error: %@",error);
    return;
}
NSLog(@"%@",arr);
```

## XML

- ä»€ä¹ˆæ˜¯XML

  - Extentsible Markup Languageï¼ˆå¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼‰
  - HTML ï¼ˆè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼‰XMLä¸HTMLååˆ†ç±»ä¼¼
  - éå¸¸ç±»ä¼¼äºHTMLï¼ŒHTMLçš„ä½œç”¨æ˜¯æ˜¾ç¤ºæ•°æ®ï¼ŒXMLçš„ç›®çš„æ˜¯å­˜å‚¨å’Œä¼ è¾“æ•°æ®
  - XMLæ˜¯å„ç§åº”ç”¨ä¹‹é—´ä¼ è¾“æ•°æ®æ˜¯ä»¥å‰å¸¸ç”¨çš„æ ¼å¼ï¼Œç°åœ¨å‡ ä¹ä¸ç”¨ï¼Œéƒ½ç”¨JSON
  - W3Cçš„æ¨èæ ‡å‡†
- XMLç”±æ ‡è®°ç»„æˆ
- <tag> è¿™å°±æ˜¯æ ‡è®°ï¼Œxmlçš„æ ‡è®°æ˜¯å¯æ‰©å±•çš„ï¼Œæ²¡æœ‰é¢„å®šä¹‰
- æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹
```objc
<Human>
    <Person color="yellow" weight="130" height="150">
        <name>wg</name>
        <age>108</age>
    </Person>
    <Student name="y" />
</Human>
```

- XMLæ ¼å¼çš„è§£ææ–¹å¼

  - SAX ï¼šiOSä¸Šè§£æï¼Œé€Ÿåº¦å¿«ï¼Œå†…å­˜å ç”¨å°ï¼Œåªè¯»
  - DOM ï¼š macä¸Šçš„è§£ææ–¹å¼ï¼ŒiOSæ— æ³•ç›´æ¥ä½¿ç”¨ï¼Œè§£æè¿‡ç¨‹ä¸­å†…å­˜å ç”¨å¤§ï¼Œè¯»å†™

- SAXçš„è§£ææ­¥éª¤ï¼š

  a. åŠ è½½xmlæ•°æ®

  b. æ‰¾å¼€å§‹èŠ‚ç‚¹(åŒ…æ‹¬èŠ‚ç‚¹çš„å±æ€§)

  c. æ‰¾èŠ‚ç‚¹ä¹‹é—´çš„å†…å®¹

  d. æ‰¾ç»“æŸèŠ‚ç‚¹

  e. ç›´åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œè§£æç»“æŸ
  
- ç½‘ç»œæ¨¡å‹ä¸­ç”¨copyä¿®é¥°ç±»ä¸­çš„å±æ€§ï¼ŒåŒ…æ‹¬NSNumber

- å¦åˆ™çš„è¯KVCèµ‹å€¼çš„valueæ˜¯NSMutableStringçš„æ—¶å€™ä¼šæœ‰é—®é¢˜ï¼Œå€¼æ˜¯å¯å˜å­—ç¬¦ä¸²ä¸­çš„æœ€åä¸€ä¸ªå€¼

```objc
NSXMLParser *parser = [[NSXMLParser alloc] initWithData:data];
// è®¾ç½®ä»£ç†, åœ¨å“ªä¸ªçº¿ç¨‹è®¾ç½®ä»£ç†ï¼Œä»£ç†æ–¹æ³•å°±æ‰§è¡Œåœ¨é‚£ä¸ªçº¿ç¨‹
parser.delegate = self;
// parseæ–¹æ³•ä»£è¡¨å¼€å§‹æ‰§è¡Œä»£ç†çš„æ–¹æ³•
[parser parse];

// å®ç°ä»£ç†æ–¹æ³•
- (void)parserDidStartDocument:(NSXMLParser *)parser{
    // å¼€å§‹è§£ææ–‡æ¡£
    
}
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary<NSString *,NSString *> *)attributeDict{
    // æ‰¾å¼€å§‹èŠ‚ç‚¹(åŒ…æ‹¬èŠ‚ç‚¹çš„å±æ€§)
    // elementName èŠ‚ç‚¹åç§°
    // attributeDict èŠ‚ç‚¹æ ‡ç­¾
    if ([elementName isEqualToString:@"video"]) {
        self.currentVideo = [[MResponse alloc] init];
        self.currentVideo.videoId = @([attributeDict[@"videoId"] intValue]);
        [self.videos addObject:self.currentVideo];
    }
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{
    // æ‰¾èŠ‚ç‚¹ä¹‹é—´çš„å†…å®¹
    [self.mStr appendString:string];
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{
    // æ‰¾ç»“æŸèŠ‚ç‚¹
    if (![elementName isEqualToString:@"video"] && ![elementName isEqualToString:@"videos"]) {
        [self.currentVideo setValue:self.mStr forKey:elementName];
    }
    [self.mStr setString:@""];
}

-(void)parserDidEndDocument:(NSXMLParser *)parser{
    // ç»“æŸè§£ææ–‡æ¡£
    NSLog(@"%@",self.videos);
}

- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError{
    // è§£æå‡ºé”™
}
```

ååˆ†å¤æ‚ï¼Œå› æ­¤ä¸å¸¸ç”¨

- DOMæ–¹å¼çš„è§£æ Document Object Model

  - DOM--æ–‡æ¡£å¯¹è±¡æ¨¡å‹(æ–‡æ¡£ğŸŒ²æ¨¡å‹)
- ä¸€æ¬¡æ€§æŠŠxmlå…¨éƒ¨åŠ è½½åˆ°å†…å­˜ï¼Œå†…å­˜æ¶ˆè€—å¤§
  - ä¹‹å‰çš„SAXæ–¹å¼åªèƒ½è¯»å–XMLï¼ŒDOMå¯ä»¥ä¿®æ”¹ï¼Œæ·»åŠ åˆ é™¤ä¿®æ”¹èŠ‚ç‚¹
- iOSé»˜è®¤ä¸æ”¯æŒDOMè§£æï¼ˆä¸æ”¯æŒNSXMLè¿™ä¸ªç±»ï¼‰
  
  - åœ¨iOSè§£æDOMçš„è¯éœ€è¦ç¬¬ä¸‰æ–¹æ¡†æ¶
    - GData/KissXML(XMPPä¸­ä½¿ç”¨æ­¤æ¡†æ¶)
- é€‚åˆè¯»å†™æ¯”è¾ƒå°çš„XMLæ–‡ä»¶
  - é€šå¸¸ç”¨GDataXMLNodeè¿™ä¸ªæ¡†æ¶åœ¨iOSä¸­ä½¿ç”¨
    - å¼•å…¥å®Œè¿™ä¸ªæ¡†æ¶åæ ¹æ®å¤´æ–‡ä»¶æœ€ä¸Šæ–¹æ³¨é‡Šçš„æç¤º
  - åœ¨é¡¹ç›®build settingsé‡Œæœç´¢ Header Search Paths è®¾ç½®ä¸º /usr/include/libxml2
    - åœ¨é¡¹ç›®build settingsé‡Œæœç´¢ Other Linker Flags è®¾ç½®ä¸º -lxml2

```objc
NSError *error;
GDataXMLDocument *document = [[GDataXMLDocument alloc] initWithData:data error:&error];
GDataXMLElement *rootElement = document.rootElement;
NSMutableArray *arrM = [NSMutableArray new];
for (GDataXMLElement *ele in rootElement.children) {
    MResponse *v = [MResponse new];
    [arrM addObject:v];
    // ç»™å¯¹è±¡çš„å±æ€§èµ‹å€¼
    // éå†å­æ ‡ç­¾
    for (GDataXMLElement *subEle in ele.children) {
        //subEle.name æ ‡ç­¾çš„åå­— subEle.stringValueå°±æ˜¯æ ‡ç­¾çš„å†…å®¹
        [v setValue:subEle.stringValue forKey:subEle.name];
    }
    // éå†å±æ€§
    for (GDataXMLNode *attr in ele.attributes) {
        [v setValue:attr.stringValue forKey:attr.name];
    }
}
if (error) {
    NSLog(@"xmlparse error: %@",error);
    return;
}
NSLog(@"%@", arrM);
```




## è·å–ç½‘ç»œæ•°æ®

- æ³•ä¸€ï¼šNSDataï¼Œè¿™ç§è®¾ç½®æ–¹æ³•ä¸èƒ½è®¾ç½®è¯·æ±‚åšä¸€äº›å“åº”çš„è®¾ç½®ï¼Œç¼“å­˜ç­–ç•¥ã€è¶…æ—¶æ—¶é•¿ã€å“åº”å¤´ç­‰ã€‚

```objc
NSURL *url = [NSURL URLWithString:@"http://127.0.0.1/aaa/demo.json"];
NSData *data = [NSData dataWithContentsOfURL:url];
NSString *str = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
NSLog(@"%@",str);
```

- æ³•äºŒï¼šNSURLConnection sendAsynchronousRequestï¼Œè¿™ä¸ªAPI iOS9å°±è¿‡æœŸäº†

```objc
NSURL *url = [NSURL URLWithString:@"http://192.168.88.100/aaa/demo.json"];
//    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
// **è®¾ç½®ç¼“å­˜ç­–ç•¥ï¼Œå’Œè¿æ¥å»¶æ—¶ï¼ˆè¶…æ—¶åä¸ç®¡æœåŠ¡å™¨æ–­ä¸æ–­å¼€è¿æ¥ï¼Œå®¢æˆ·ç«¯éƒ½æ–­å¼€**
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:15];
// æ·»åŠ å“åº”å¤´
[request setValue:@"Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1" forHTTPHeaderField:@"User-Agent"];
[NSURLConnection sendAsynchronousRequest:request queue:self.queue completionHandler:^(NSURLResponse * _Nullable response, NSData * _Nullable data, NSError * _Nullable connectionError) {
    if (connectionError) {
        NSLog(@"connect error");
        return;
    }
    NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse*)response;
    if (httpResponse.statusCode != 200 && httpResponse.statusCode != 304) {
        NSLog(@"server error");
        return;
    }
    NSString *str = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    NSLog(@"%@", str);
}];
```

- æ³•ä¸‰

